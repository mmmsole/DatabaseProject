Queries on the epic battle Max Verstappen vs Lewis Hamilton in 2021 season.
The final race of 2021 Formula 1 season, unsurprisingly, came down to dual between Max Verstappen
and Lewis Hamilton for the victory at the Abu Dhabi grand prix.
Anyway, this epic battle was far from being unexpected. The whole season was highlighted by fierce battles between the 
two drivers. Letâ€™s see some insights of such racing fight.

1.	Total number of pitstops in 2021 season for Max Verstappen and Lewis Hamilton (Done)
2.	Total number of pitstops per race for Max Verstappen and Lewis Hamilton in 2021 season (Done)
3.  All drivers who did less pitstops than the 2021 World Champion (Max Verstappen) (Done)

Further queries describing the last 20 years of Formula1 in general
4.  Given a year, return a list containing the driver who achieved the fastest lap on each circuit
5.  Driver standings for a given season (Done)
6.	List the total points scored by each driver having Italian nationality
7.	List of all drivers who have never won a race
8.  Average number of pitstops per race in the last 20 years



1)
I consider the table PitStop, table Drivers for the name, and table Races for the year

Number of pit stops for Max Verstappen in 2021:

    Select d.name as Name, d.surname as Surname, d.number as DriverNumber, r.raceYear as Year, count(p.stopNumber) as NumPitStops
	From PitStops as p, Drivers as d, Races as r
	Where p.driverId = d.driverId and p.raceId = r.raceId and r.raceYear = 2021
	Group by d.driverId
	Having d.name = 'Max'  and d.surname = 'Verstappen' 

Number of pit stops for Lewis Hamilton in 2021:

    Select d.name as Name, d.surname as Surname, d.number as DriverNumber, r.raceYear as Year, count(p.stopNumber) as NumPitStops
	From PitStops as p, Drivers as d, Races as r
	Where p.driverId = d.driverId and p.raceId = r.raceId and r.raceYear = 2021
	Group by d.driverId
	Having d.name = 'Lewis'  and d.surname = 'Hamilton'


2) 
Total number of pitstops per race for Max Verstappen in 2021 season:

    Select d.name as Name, d.surname as Surname, d.number as DriverNumber, r.raceYear as Year, r.raceName as GrandPrix, c.name as CircuitName, count(*) as NumPitStops
    From PitStops as p, Races as r, Drivers as d, Circuits as c
    Where p.raceId = r.raceId and p.driverId = d.driverId and r.circuitId = c.circuitId and r.raceYear = 2021
    Group by r.raceName, d.driverId
    Having d.name = 'Max' and d.surname = 'Verstappen'

Total number of pitstops per race for Lewis Hamilton in 2021 season:

    Select d.name as Name, d.surname as Surname, d.number as DriverNumber, r.raceYear as Year, r.raceName as GrandPrix, c.name as CircuitName, count(*) as NumPitStops
    From PitStops as p, Races as r, Drivers as d, Circuits as c
    Where p.raceId = r.raceId and p.driverId = d.driverId and r.circuitId = c.circuitId and r.raceYear = 2021
    Group by r.raceName, d.driverId
    Having d.name = 'Lewis' and d.surname = 'Hamilton'

3)
All drivers who did less pitstops than the 2021 World Champion (Max Verstappen)

Select d.name as Name, d.surname as Surname, d.number as DriverNumber, r.raceYear as Year, count(*) as NumPitStops
From PitStops as p, Drivers as d, Races as r
Where p.driverId = d.driverId and p.raceId = r.raceId and r.raceYear = 2021
Group by d.name
Having count(*) < (
    Select x.NumPitStops
    From (
        Select d.name as Name, d.surname as Surname, d.number as DriverNumber, r.raceYear as Year, count(*) as NumPitStops
	    From PitStops as p, Drivers as d, Races as r
	    Where p.driverId = d.driverId and p.raceId = r.raceId and r.raceYear = 2021
	    Group by d.name
	    Having d.name = 'Max'  and d.surname = 'Verstappen'
    ) as x
)

4)
Given a year, return a list containing the driver who achieved the fastest lap on each circuit

Select
From Races as r, Drivers as d, Circuits as c, LapTimes as l
Where r.raceId = l.raceId and d.driverId = l.driver.id and r.circuitId = c.circuitId and r.raceYear = 2021
Group by r.raceName
Having l.ms = (
	Select
)







5)
Drivers' standings for a given season

Select  d.name, d.surname, d.number, sum(res.points) as Standings
From Drivers as d, Results as res, Races as r
Where d.driverId = res.driverId and r.raceId = res.raceId and r.raceYear = 2021
Group by d.name, d.surname
Order by Standings DESC

6)









